<form #makeOrderForm="ngForm">

  <ng-template #makeOrderContent let-c="close" let-d="dismiss">
    <div class="modal-header">
      <h4 class="modal-title">New order</h4>
      <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-body">
      <div class="form-group">
        <label>Users</label>
        <ul class="list-group">
          <li class="list-group-item" *ngFor="let clientExchange of selectedClientsExchanges">
            <span class="badge badge-info">
              {{ clientExchange.exchangeName }}
            </span>
            of
            {{ clientExchange.client.name }}
          </li>
        </ul>
      </div>

      <div class="form-group">
        <label for="typeahead-basic">Exchange currency pair</label>
        <input name="exchangePair" id="typeahead-basic" type="text" class="form-control exchange-pair-input"
          [class.is-invalid]="makeOrderForm.controls.exchangePair && makeOrderForm.controls.exchangePair.invalid && makeOrderForm.controls.exchangePair.touched"
          required validateCurrencyPairSymbol
          [(ngModel)]="exchangePair" [ngbTypeahead]="searchExchangePair" (input)="$event.target.value = $event.target.value.toUpperCase()">
        <div class="invalid-feedback">Provide valid exchange pair</div>
      </div>

      <div class="row">
        <div class="col-md-6">
          <div class="form-group">
            <label for="order-type">Order type</label>
            <select name="orderType" [(ngModel)]="orderType" id="order-type" class="form-control">
              <option value="buy">Buy</option>
              <option value="sell">Sell</option>
            </select>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-group">
            <label for="waller-percentage">Wallet percentage</label>
            <div class="input-group">
              <input name="walletPercentage" type="number" class="form-control" min="1" max="100" [(ngModel)]="walletPercentage" (input)="onWalletPercentageChanges($event.target)">
              <div class="input-group-append">
                <span class="input-group-text">%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <p><ngb-progressbar [type]="orderType == 'buy' ? 'success' : 'danger'" [value]="walletPercentage">{{ walletPercentage }}</ngb-progressbar></p>

    </div>
    <div class="modal-footer justify-content-center">
        <button type="submit" class="btn btn-primary" (click)="showConfirmOrder()" [disabled]="makeOrderForm.invalid">Make order</button>
    </div>

</ng-template>

</form>

<ng-template #confirmOrderContent let-c="close" let-d="dismiss">
  <div class="modal-header">
      <h4 class="modal-title">Making order confirmation</h4>
      <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body">
      <p>
        Do you want to make new order of

        <span *ngIf="orderType == 'buy'">buying {{ baseCurrency }} for {{ walletPercentage }}% of {{ counterCurrency }}</span>
        <span *ngIf="orderType == 'sell'">selling {{ walletPercentage }}% {{ baseCurrency }} to {{ counterCurrency }}</span>

      </p>
  </div>
  <div class="modal-footer">
      <button type="button" class="btn btn-danger" (click)="c('delete')">Yes. I am sure.</button>
      <button type="button" class="btn btn-secondary" (click)="d('Dismiss')">Dismiss</button>
  </div>
</ng-template>
